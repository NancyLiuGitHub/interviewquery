three day rolling avg
for deposits, value > 0
avg() over ()

SELECT dt, 
avg(deposit) over (order by dt range between 2 preceding) as rolling_three_day
from (
select date(created_at) dt, sum(transaction_value) as deposit
from bank_transactions
where transaction_value > 0
group by date(created_at)
) t
